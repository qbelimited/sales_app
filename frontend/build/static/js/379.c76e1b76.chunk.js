"use strict";(self.webpackChunkSales_tracking_app=self.webpackChunkSales_tracking_app||[]).push([[379],{7379:(e,a,t)=>{t.r(a),t.d(a,{default:()=>p});var s=t(5043),l=t(1072),r=t(8602),n=t(3814),i=t(4282),c=t(7417),d=t(4196),o=t(1899),x=t.n(o),h=(t(5015),t(9621)),m=t(3204),g=t(579);const p=e=>{let{showToast:a}=e;const[t,o]=(0,s.useState)([]),[p,j]=(0,s.useState)(!0),[u,v]=(0,s.useState)(null),[N,y]=(0,s.useState)({type:"",level:"",startDate:null,endDate:null}),[A,b]=(0,s.useState)(1),[D]=(0,s.useState)(50),[S,f]=(0,s.useState)(1),k=(0,s.useCallback)((async()=>{j(!0),v(null);try{const e={page:A,per_page:D,...N.type&&{type:N.type},...N.level&&{level:N.level},...N.startDate&&{start_date:N.startDate.toISOString()},...N.endDate&&{end_date:N.endDate.toISOString()}},a=await h.A.get("/logs/",{params:e});o(a.data.logs||[]),f(a.data.total_pages||1)}catch(u){console.error("Error fetching logs:",u);let t="Failed to fetch logs. Please try again later.";u.response?t=u.response.data.message||t:u.request&&(t="Network error: Unable to reach the server."),v(t),a("danger",t,"Error")}finally{j(!1)}}),[A,D,N,a]);(0,s.useEffect)((()=>{k()}),[k]);const C=e=>{e<1||e>S||b(e)},F=Math.max(1,A-Math.floor(2.5)),L=Math.min(S,F+5-1),R=t.map((e=>(e=>{const a=/(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2},\d{3})/,t=e.match(a);if(t){const s=t[0],l=e.replace(a,"").trim(),r=new Date(s.replace(",","."));return{timestamp:isNaN(r.getTime())?"Invalid Date":r,message:l}}return{timestamp:"No Timestamp",message:e}})(e)));return(0,g.jsxs)("div",{style:{marginTop:"20px",padding:"20px"},children:[(0,g.jsx)(l.A,{className:"mb-4",children:(0,g.jsx)(r.A,{children:(0,g.jsx)("h2",{children:"Logs"})})}),(0,g.jsx)(n.A,{className:"mb-4",children:(0,g.jsxs)(l.A,{className:"align-items-end",children:[(0,g.jsx)(r.A,{xs:12,md:3,lg:2,children:(0,g.jsxs)(n.A.Control,{as:"select",value:N.type,onChange:e=>y({...N,type:e.target.value}),"aria-label":"Log Type",children:[(0,g.jsx)("option",{value:"",children:"Log Type"}),(0,g.jsx)("option",{value:"general",children:"General"}),(0,g.jsx)("option",{value:"error",children:"Error"}),(0,g.jsx)("option",{value:"success",children:"Success"})]})}),(0,g.jsx)(r.A,{xs:12,md:3,lg:2,children:(0,g.jsxs)(n.A.Control,{as:"select",value:N.level,onChange:e=>y({...N,level:e.target.value}),"aria-label":"Log Level",children:[(0,g.jsx)("option",{value:"",children:"Log Level"}),(0,g.jsx)("option",{value:"INFO",children:"INFO"}),(0,g.jsx)("option",{value:"WARNING",children:"WARNING"}),(0,g.jsx)("option",{value:"ERROR",children:"ERROR"})]})}),(0,g.jsx)(r.A,{xs:12,md:3,lg:2,children:(0,g.jsx)(x(),{selected:N.startDate,onChange:e=>y({...N,startDate:e}),placeholderText:"Start Date",className:"form-control","aria-label":"Start Date",showTimeSelect:!0,dateFormat:"Pp"})}),(0,g.jsx)(r.A,{xs:12,md:3,lg:2,children:(0,g.jsx)(x(),{selected:N.endDate,onChange:e=>y({...N,endDate:e}),placeholderText:"End Date",className:"form-control","aria-label":"End Date",showTimeSelect:!0,dateFormat:"Pp"})}),(0,g.jsxs)(r.A,{xs:12,md:3,lg:2,children:[(0,g.jsxs)(i.A,{variant:"primary",onClick:()=>{N.startDate&&N.endDate&&N.startDate>N.endDate?a("warning","Start date must be before end date.","Invalid Date Range"):(b(1),k())},"aria-label":"Filter Logs",children:[(0,g.jsx)(m.KSO,{})," Filter"]}),(0,g.jsxs)(i.A,{variant:"secondary",onClick:()=>{y({type:"",level:"",startDate:null,endDate:null}),b(1),k()},className:"ms-2","aria-label":"Reset Filters",children:[(0,g.jsx)(m.EEI,{})," Reset"]})]})]})}),u&&(0,g.jsx)("p",{className:"text-center text-danger",children:u}),p&&(0,g.jsx)("div",{className:"text-center my-3",children:(0,g.jsx)(c.A,{animation:"border","aria-label":"Loading logs..."})}),!p&&(0,g.jsxs)(d.A,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[(0,g.jsx)("thead",{children:(0,g.jsxs)("tr",{children:[(0,g.jsx)("th",{children:"#"}),(0,g.jsx)("th",{children:"Timestamp"}),(0,g.jsx)("th",{children:"Message"})]})}),(0,g.jsx)("tbody",{children:R.length>0?R.map(((e,a)=>(0,g.jsxs)("tr",{children:[(0,g.jsx)("td",{children:(A-1)*D+a+1}),(0,g.jsx)("td",{children:"string"===typeof e.timestamp?e.timestamp:e.timestamp.toLocaleString()}),(0,g.jsx)("td",{children:e.message})]},a))):(0,g.jsx)("tr",{children:(0,g.jsx)("td",{colSpan:"3",className:"text-center",children:"No logs found"})})})]}),!p&&S>1&&(0,g.jsx)(l.A,{className:"mt-3",children:(0,g.jsxs)(r.A,{className:"text-center",children:[A>1&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(i.A,{variant:"secondary",onClick:()=>C(1),className:"mx-1","aria-label":"First Page",children:(0,g.jsx)(m.X8f,{})}),(0,g.jsx)(i.A,{variant:"secondary",onClick:()=>C(A-1),className:"mx-1","aria-label":"Previous Page",children:(0,g.jsx)(m.QVr,{})})]}),[...Array(L-F+1).keys()].map((e=>(0,g.jsx)(i.A,{variant:A===F+e?"primary":"secondary",onClick:()=>C(F+e),className:"mx-1","aria-label":`Page ${F+e}`,children:F+e},F+e))),A<S&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(i.A,{variant:"secondary",onClick:()=>C(A+1),className:"mx-1","aria-label":"Next Page",children:(0,g.jsx)(m.Z0P,{})}),(0,g.jsx)(i.A,{variant:"secondary",onClick:()=>C(S),className:"mx-1","aria-label":"Last Page",children:(0,g.jsx)(m.eaw,{})})]})]})})]})}}}]);
//# sourceMappingURL=379.c76e1b76.chunk.js.map