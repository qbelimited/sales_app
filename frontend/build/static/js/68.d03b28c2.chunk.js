"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[68],{1068:(e,s,a)=>{a.r(s),a.d(s,{default:()=>u});var r=a(5043),c=a(7417),n=a(1072),t=a(8602),l=a(4282),d=a(4196),i=a(5751),o=a(3814),h=a(3204),x=a(9621),j=a(579);const u=e=>{let{showToast:s}=e;const[a,u]=(0,r.useState)([]),[p,A]=(0,r.useState)([]),[g,_]=(0,r.useState)(!0),[C,m]=(0,r.useState)(null),[v,y]=(0,r.useState)(!1),[k,b]=(0,r.useState)(null),[f,w]=(0,r.useState)(""),[N,$]=(0,r.useState)(""),[S,R]=(0,r.useState)(!1),[E,F]=(0,r.useState)({role_id:"",can_create:!1,can_update:!1,can_delete:!1,can_view_logs:!1,can_manage_users:!1,can_view_audit_trail:!1}),[U,P]=(0,r.useState)(!1),[T,Y]=(0,r.useState)(null),z=(0,r.useCallback)((async()=>{_(!0),m(null);try{const e=await x.A.get("/roles/");u(e.data||[]);const s=await x.A.get("/access/");A(s.data||[])}catch(C){console.error("Error fetching data:",C),m("Failed to fetch data. Please try again later."),s("danger","Failed to fetch data. Please try again later.","Error")}finally{_(!1)}}),[s]);(0,r.useEffect)((()=>{z()}),[z]);const B=e=>{Y(e),P(!0)};return g?(0,j.jsx)(c.A,{animation:"border"}):(0,j.jsxs)("div",{style:{marginTop:"20px",padding:"20px"},children:[(0,j.jsxs)(n.A,{className:"mb-3",children:[(0,j.jsx)(t.A,{children:(0,j.jsx)("h2",{children:"Manage Roles"})}),(0,j.jsx)(t.A,{className:"text-right",children:(0,j.jsx)(l.A,{onClick:()=>y(!0),children:"Create New Role"})})]}),C&&(0,j.jsx)("p",{className:"text-center text-danger",children:C}),(0,j.jsxs)(d.A,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[(0,j.jsx)("thead",{children:(0,j.jsxs)("tr",{children:[(0,j.jsx)("th",{children:"#"}),(0,j.jsx)("th",{children:"Role Name"}),(0,j.jsx)("th",{children:"Description"}),(0,j.jsx)("th",{children:"Actions"})]})}),(0,j.jsx)("tbody",{children:a.length>0?a.map(((e,s)=>(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{children:s+1}),(0,j.jsx)("td",{children:e.name}),(0,j.jsx)("td",{children:e.description}),(0,j.jsxs)("td",{children:[(0,j.jsx)(l.A,{variant:"link",size:"sm",onClick:()=>(e=>{b(e),w(e.name),$(e.description),y(!0)})(e),children:(0,j.jsx)(h.F7,{})}),(0,j.jsx)(l.A,{variant:"link",size:"sm",onClick:()=>B(e),children:(0,j.jsx)(h.qbC,{})})]})]},e.id))):(0,j.jsx)("tr",{children:(0,j.jsx)("td",{colSpan:"4",className:"text-center",children:"No roles found"})})})]}),(0,j.jsxs)(n.A,{className:"mt-5 mb-3",children:[(0,j.jsx)(t.A,{children:(0,j.jsx)("h2",{children:"Access Management"})}),(0,j.jsx)(t.A,{className:"text-right",children:(0,j.jsx)(l.A,{onClick:()=>R(!0),children:"Create New Access"})})]}),(0,j.jsxs)(d.A,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[(0,j.jsx)("thead",{children:(0,j.jsxs)("tr",{children:[(0,j.jsx)("th",{children:"Role Name"}),(0,j.jsx)("th",{children:"Can Create"}),(0,j.jsx)("th",{children:"Can Update"}),(0,j.jsx)("th",{children:"Can Delete"}),(0,j.jsx)("th",{children:"Can View Logs"}),(0,j.jsx)("th",{children:"Can Manage Users"}),(0,j.jsx)("th",{children:"Can View Audit Trail"}),(0,j.jsx)("th",{children:"Actions"})]})}),(0,j.jsx)("tbody",{children:p.length>0?p.map((e=>{const s=a.find((s=>s.id===e.role_id));return(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{children:s?s.name:"Role Not Found"}),(0,j.jsx)("td",{children:e.can_create?"Yes":"No"}),(0,j.jsx)("td",{children:e.can_update?"Yes":"No"}),(0,j.jsx)("td",{children:e.can_delete?"Yes":"No"}),(0,j.jsx)("td",{children:e.can_view_logs?"Yes":"No"}),(0,j.jsx)("td",{children:e.can_manage_users?"Yes":"No"}),(0,j.jsx)("td",{children:e.can_view_audit_trail?"Yes":"No"}),(0,j.jsxs)("td",{children:[(0,j.jsx)(l.A,{variant:"link",size:"sm",onClick:()=>(e=>{F(e),R(!0)})(e),children:(0,j.jsx)(h.F7,{})}),(0,j.jsx)(l.A,{variant:"link",size:"sm",onClick:()=>B(s),children:(0,j.jsx)(h.qbC,{})})]})]},e.role_id)})):(0,j.jsx)("tr",{children:(0,j.jsx)("td",{colSpan:"8",className:"text-center",children:"No access records found"})})})]}),(0,j.jsxs)(i.A,{show:v,onHide:()=>y(!1),children:[(0,j.jsx)(i.A.Header,{closeButton:!0,children:(0,j.jsx)(i.A.Title,{children:k?"Edit Role":"Create Role"})}),(0,j.jsx)(i.A.Body,{children:(0,j.jsxs)(o.A,{children:[(0,j.jsxs)(o.A.Group,{children:[(0,j.jsx)(o.A.Label,{children:"Role Name"}),(0,j.jsx)(o.A.Control,{type:"text",placeholder:"Enter role name",value:f,onChange:e=>w(e.target.value)})]}),(0,j.jsxs)(o.A.Group,{children:[(0,j.jsx)(o.A.Label,{children:"Description"}),(0,j.jsx)(o.A.Control,{type:"text",placeholder:"Enter description",value:N,onChange:e=>$(e.target.value)})]})]})}),(0,j.jsxs)(i.A.Footer,{children:[(0,j.jsx)(l.A,{variant:"secondary",onClick:()=>y(!1),children:"Close"}),(0,j.jsx)(l.A,{variant:"primary",onClick:async()=>{try{k?(await x.A.put(`/roles/${k.id}`,{name:f,description:N}),s("success","Role updated successfully!","Success")):(await x.A.post("/roles/",{name:f,description:N}),s("success","Role created successfully!","Success")),z(),y(!1),w(""),$(""),b(null)}catch(C){console.error("Error saving role:",C),s("danger","Failed to save role. Please try again.","Error")}},children:k?"Update Role":"Create Role"})]})]}),(0,j.jsxs)(i.A,{show:S,onHide:()=>R(!1),children:[(0,j.jsx)(i.A.Header,{closeButton:!0,children:(0,j.jsx)(i.A.Title,{children:E.role_id?"Edit Access":"Create Access"})}),(0,j.jsx)(i.A.Body,{children:(0,j.jsxs)(o.A,{children:[(0,j.jsxs)(o.A.Group,{children:[(0,j.jsx)(o.A.Label,{children:"Role"}),(0,j.jsxs)(o.A.Control,{as:"select",value:E.role_id,onChange:e=>F({...E,role_id:parseInt(e.target.value,10)}),disabled:!!E.role_id,children:[(0,j.jsx)("option",{value:"",children:"Select a Role"}),a.map((e=>(0,j.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,j.jsxs)(o.A.Group,{children:[(0,j.jsx)(o.A.Check,{type:"checkbox",label:"Can Create",checked:E.can_create,onChange:e=>F({...E,can_create:e.target.checked})}),(0,j.jsx)(o.A.Check,{type:"checkbox",label:"Can Update",checked:E.can_update,onChange:e=>F({...E,can_update:e.target.checked})}),(0,j.jsx)(o.A.Check,{type:"checkbox",label:"Can Delete",checked:E.can_delete,onChange:e=>F({...E,can_delete:e.target.checked})}),(0,j.jsx)(o.A.Check,{type:"checkbox",label:"Can View Logs",checked:E.can_view_logs,onChange:e=>F({...E,can_view_logs:e.target.checked})}),(0,j.jsx)(o.A.Check,{type:"checkbox",label:"Can Manage Users",checked:E.can_manage_users,onChange:e=>F({...E,can_manage_users:e.target.checked})}),(0,j.jsx)(o.A.Check,{type:"checkbox",label:"Can View Audit Trail",checked:E.can_view_audit_trail,onChange:e=>F({...E,can_view_audit_trail:e.target.checked})})]})]})}),(0,j.jsxs)(i.A.Footer,{children:[(0,j.jsx)(l.A,{variant:"secondary",onClick:()=>R(!1),children:"Close"}),(0,j.jsx)(l.A,{variant:"primary",onClick:async()=>{try{if(E.role_id){const e=await x.A.put(`/access/${E.role_id}`,{...E,role_id:parseInt(E.role_id,10)});console.log(e.data),s("success","Access updated successfully!","Success")}else{const e=await x.A.post("/access/",{...E,role_id:parseInt(E.role_id,10)});console.log(e.data),s("success","Access created successfully!","Success")}z(),R(!1),F({role_id:"",can_create:!1,can_update:!1,can_delete:!1,can_view_logs:!1,can_manage_users:!1,can_view_audit_trail:!1})}catch(C){console.error("Error saving access:",C.response?C.response.data:C.message),C.response&&401===C.response.status?s("danger","Unauthorized. Please log in again.","Error"):C.response&&403===C.response.status?s("danger","Forbidden. You do not have permission to update access.","Error"):s("danger","Failed to save access. Please try again.","Error")}},children:E.role_id?"Update Access":"Create Access"})]})]}),(0,j.jsxs)(i.A,{show:U,onHide:()=>P(!1),children:[(0,j.jsx)(i.A.Header,{closeButton:!0,children:(0,j.jsx)(i.A.Title,{children:"Confirm Deletion"})}),(0,j.jsx)(i.A.Body,{children:"Are you sure you want to delete this role? Any associated access will also be deleted."}),(0,j.jsxs)(i.A.Footer,{children:[(0,j.jsx)(l.A,{variant:"secondary",onClick:()=>P(!1),children:"Cancel"}),(0,j.jsx)(l.A,{variant:"danger",onClick:async()=>{P(!1);try{const e=p.find((e=>e.role_id===T.id));await x.A.delete(`/roles/${T.id}`),e&&await x.A.delete("/access/",{data:{role_id:T.id}}),s("success","Role and associated access deleted successfully!","Success"),z()}catch(C){console.error("Error deleting role or access:",C),s("danger","Failed to delete role and access. Please try again.","Error")}},children:"Confirm Delete"})]})]})]})}},1072:(e,s,a)=>{a.d(s,{A:()=>i});var r=a(8139),c=a.n(r),n=a(5043),t=a(7852),l=a(579);const d=n.forwardRef(((e,s)=>{let{bsPrefix:a,className:r,as:n="div",...d}=e;const i=(0,t.oU)(a,"row"),o=(0,t.gy)(),h=(0,t.Jm)(),x=`${i}-cols`,j=[];return o.forEach((e=>{const s=d[e];let a;delete d[e],null!=s&&"object"===typeof s?({cols:a}=s):a=s;const r=e!==h?`-${e}`:"";null!=a&&j.push(`${x}${r}-${a}`)})),(0,l.jsx)(n,{ref:s,...d,className:c()(r,i,...j)})}));d.displayName="Row";const i=d},4196:(e,s,a)=>{a.d(s,{A:()=>d});var r=a(8139),c=a.n(r),n=a(5043),t=a(7852),l=a(579);const d=n.forwardRef(((e,s)=>{let{bsPrefix:a,className:r,striped:n,bordered:d,borderless:i,hover:o,size:h,variant:x,responsive:j,...u}=e;const p=(0,t.oU)(a,"table"),A=c()(r,p,x&&`${p}-${x}`,h&&`${p}-${h}`,n&&`${p}-${"string"===typeof n?`striped-${n}`:"striped"}`,d&&`${p}-bordered`,i&&`${p}-borderless`,o&&`${p}-hover`),g=(0,l.jsx)("table",{...u,className:A,ref:s});if(j){let e=`${p}-responsive`;return"string"===typeof j&&(e=`${e}-${j}`),(0,l.jsx)("div",{className:e,children:g})}return g}))}}]);
//# sourceMappingURL=68.d03b28c2.chunk.js.map