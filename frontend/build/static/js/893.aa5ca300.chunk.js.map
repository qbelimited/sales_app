{"version":3,"file":"static/js/893.aa5ca300.chunk.js","mappings":"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","sources":["pages/AuditTrailPage.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\r\nimport { Table, Row, Col, Button, Form, Modal } from 'react-bootstrap';\r\nimport { FaSearch, FaInfoCircle, FaArrowLeft, FaArrowRight, FaAngleDoubleLeft, FaAngleDoubleRight } from 'react-icons/fa';\r\nimport DatePicker from 'react-datepicker';\r\nimport 'react-datepicker/dist/react-datepicker.css';\r\nimport api from '../services/api';\r\n\r\nconst AuditTrailPage = ({ showToast }) => {\r\n  const [auditLogs, setAuditLogs] = useState([]);\r\n  const [users, setUsers] = useState({});\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [filter, setFilter] = useState({\r\n    resourceType: '',\r\n    action: '',\r\n    startDate: null,\r\n    endDate: null,\r\n  });\r\n  const [showDetailsModal, setShowDetailsModal] = useState(false);\r\n  const [selectedLog, setSelectedLog] = useState(null);\r\n  const [resourceTypes, setResourceTypes] = useState([]);\r\n  const [actions, setActions] = useState([]);\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [itemsPerPage] = useState(50);\r\n  const [archiveView, setArchiveView] = useState('current'); // 'current', 'previous', 'older'\r\n\r\n  // Fetch all audit logs\r\n  const fetchAuditLogs = useCallback(async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n    try {\r\n      const response = await api.get('/audit_trail/');\r\n      const logs = response.data || [];\r\n      setAuditLogs(logs);\r\n      extractUniqueResourceTypesAndActions(logs);\r\n    } catch (error) {\r\n      console.error('Error fetching audit logs:', error);\r\n      setError('Failed to fetch audit logs. Please try again later.');\r\n      showToast('danger', 'Failed to fetch audit logs. Please try again later.', 'Error');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [showToast]);\r\n\r\n  // Extract unique resource types and actions from the audit logs\r\n  const extractUniqueResourceTypesAndActions = (logs) => {\r\n    const uniqueResourceTypes = [...new Set(logs.map((log) => log.resource_type))];\r\n    const uniqueActions = [...new Set(logs.map((log) => log.action.replace('AuditAction.', '')))]; // Remove 'AuditAction.' prefix\r\n    setResourceTypes(uniqueResourceTypes);\r\n    setActions(uniqueActions);\r\n  };\r\n\r\n  // Fetch all users to map user IDs to names\r\n  const fetchUsers = useCallback(async () => {\r\n    try {\r\n      const response = await api.get('/users/');\r\n      const usersMap = {};\r\n      response.data.users.forEach((user) => {\r\n        usersMap[user.id] = user.name;\r\n      });\r\n      setUsers(usersMap);\r\n    } catch (error) {\r\n      console.error('Error fetching users:', error);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchAuditLogs();\r\n    fetchUsers();\r\n  }, [fetchAuditLogs, fetchUsers]);\r\n\r\n  // Handle filtering\r\n  const handleFilter = async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n    try {\r\n      const response = await api.post('/audit_trail/filter', filter);\r\n      const logs = response.data || [];\r\n      setAuditLogs(logs);\r\n      extractUniqueResourceTypesAndActions(logs);\r\n      setCurrentPage(1); // Reset to the first page after filtering\r\n    } catch (error) {\r\n      console.error('Error filtering audit logs:', error);\r\n      setError('Failed to filter audit logs. Please try again later.');\r\n      showToast('danger', 'Failed to filter audit logs. Please try again later.', 'Error');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Handle viewing details of a specific log\r\n  const handleViewDetails = async (logId) => {\r\n    setLoading(true);\r\n    setError(null);\r\n    try {\r\n      const response = await api.get(`/audit_trail/${logId}`);\r\n      setSelectedLog(response.data);\r\n      setShowDetailsModal(true);\r\n    } catch (error) {\r\n      console.error('Error fetching log details:', error);\r\n      showToast('danger', 'Failed to fetch log details. Please try again later.', 'Error');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Calculate the current logs to display based on pagination and archive view\r\n  const filteredLogs = auditLogs.filter((log) => {\r\n    const logDate = new Date(log.timestamp);\r\n    const today = new Date();\r\n    if (archiveView === 'current') {\r\n      return logDate >= new Date(today.setDate(today.getDate() - today.getDay())); // Current week\r\n    } else if (archiveView === 'previous') {\r\n      return (\r\n        logDate < new Date(today.setDate(today.getDate() - today.getDay())) &&\r\n        logDate >= new Date(today.setDate(today.getDate() - 7))\r\n      ); // Previous week\r\n    } else {\r\n      return logDate < new Date(today.setDate(today.getDate() - 7)); // Older than previous week\r\n    }\r\n  });\r\n\r\n  const indexOfLastLog = currentPage * itemsPerPage;\r\n  const indexOfFirstLog = indexOfLastLog - itemsPerPage;\r\n  const currentLogs = filteredLogs.slice(indexOfFirstLog, indexOfLastLog);\r\n\r\n  // Handle page change\r\n  const handlePageChange = (pageNumber) => setCurrentPage(pageNumber);\r\n\r\n  // Calculate the number of pages to show in pagination\r\n  const totalPages = Math.ceil(filteredLogs.length / itemsPerPage);\r\n  const maxPageNumbers = 5;\r\n  const startPage = Math.max(1, currentPage - Math.floor(maxPageNumbers / 2));\r\n  const endPage = Math.min(totalPages, startPage + maxPageNumbers - 1);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"loading-container\">\r\n        <div className=\"spinner\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"audit-trail-page\" style={{ marginTop: '20px', padding: '20px' }}>\r\n      <Row className=\"mb-4\">\r\n        <Col>\r\n          <h2>Audit Trail</h2>\r\n        </Col>\r\n      </Row>\r\n\r\n      {/* Filter Section */}\r\n      <Form className=\"mb-4\">\r\n        <Row className=\"align-items-end\">\r\n          <Col md={2}>\r\n            <Form.Control\r\n              as=\"select\"\r\n              value={filter.resourceType}\r\n              onChange={(e) => setFilter({ ...filter, resourceType: e.target.value })}\r\n            >\r\n              <option value=\"\">Resource Type</option>\r\n              {resourceTypes.map((type) => (\r\n                <option key={type} value={type}>{type}</option>\r\n              ))}\r\n            </Form.Control>\r\n          </Col>\r\n          <Col md={2}>\r\n            <Form.Control\r\n              as=\"select\"\r\n              value={filter.action}\r\n              onChange={(e) => setFilter({ ...filter, action: e.target.value })}\r\n            >\r\n              <option value=\"\">Action</option>\r\n              {actions.map((action) => (\r\n                <option key={action} value={action}>{action}</option>\r\n              ))}\r\n            </Form.Control>\r\n          </Col>\r\n          <Col md={2}>\r\n            <DatePicker\r\n              selected={filter.startDate}\r\n              onChange={(date) => setFilter({ ...filter, startDate: date })}\r\n              placeholderText=\"Start Date\"\r\n              className=\"form-control\"\r\n            />\r\n          </Col>\r\n          <Col md={2}>\r\n            <DatePicker\r\n              selected={filter.endDate}\r\n              onChange={(date) => setFilter({ ...filter, endDate: date })}\r\n              placeholderText=\"End Date\"\r\n              className=\"form-control\"\r\n            />\r\n          </Col>\r\n          <Col md={2}>\r\n            <Button variant=\"primary\" onClick={handleFilter}>\r\n              <FaSearch /> Filter\r\n            </Button>\r\n          </Col>\r\n        </Row>\r\n      </Form>\r\n\r\n      {error && <p className=\"text-center text-danger\">{error}</p>}\r\n\r\n      {/* Archive Toggle */}\r\n      <Row className=\"mb-4\">\r\n        <Col>\r\n          <Button variant={archiveView === 'current' ? 'primary' : 'secondary'} onClick={() => setArchiveView('current')}>\r\n            Current Week\r\n          </Button>{' '}\r\n          <Button variant={archiveView === 'previous' ? 'primary' : 'secondary'} onClick={() => setArchiveView('previous')}>\r\n            Previous Week\r\n          </Button>{' '}\r\n          <Button variant={archiveView === 'older' ? 'primary' : 'secondary'} onClick={() => setArchiveView('older')}>\r\n            Older\r\n          </Button>\r\n        </Col>\r\n      </Row>\r\n\r\n      {/* Audit Logs Table */}\r\n      <Table striped bordered hover responsive>\r\n        <thead>\r\n          <tr>\r\n            <th>#</th>\r\n            <th>Resource Type</th>\r\n            <th>Action</th>\r\n            <th>User</th>\r\n            <th>Resource ID</th>\r\n            <th>Details</th>\r\n            <th>Date</th>\r\n            <th>Actions</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {currentLogs.length > 0 ? (\r\n            currentLogs.map((log, index) => (\r\n              <tr key={log.id}>\r\n                <td>{indexOfFirstLog + index + 1}</td>\r\n                <td>{log.resource_type}</td>\r\n                <td>{log.action.replace('AuditAction.', '')}</td>\r\n                <td>{users[log.user_id] || 'Unknown User'}</td>\r\n                <td>{log.resource_id || 'N/A'}</td>\r\n                <td>{log.details}</td>\r\n                <td>{new Date(log.timestamp).toLocaleString()}</td>\r\n                <td>\r\n                  <Button variant=\"link\" size=\"sm\" onClick={() => handleViewDetails(log.id)}>\r\n                    <FaInfoCircle /> Details\r\n                  </Button>\r\n                </td>\r\n              </tr>\r\n            ))\r\n          ) : (\r\n            <tr>\r\n              <td colSpan=\"8\" className=\"text-center\">No audit logs found</td>\r\n            </tr>\r\n          )}\r\n        </tbody>\r\n      </Table>\r\n\r\n      {/* Pagination Controls */}\r\n      <Row className=\"mt-3\">\r\n        <Col className=\"text-center\">\r\n          {currentPage > 1 && (\r\n            <>\r\n              <Button variant=\"secondary\" onClick={() => handlePageChange(1)} className=\"mx-1\">\r\n                <FaAngleDoubleLeft />\r\n              </Button>\r\n              <Button variant=\"secondary\" onClick={() => handlePageChange(currentPage - 1)} className=\"mx-1\">\r\n                <FaArrowLeft />\r\n              </Button>\r\n            </>\r\n          )}\r\n          {[...Array(endPage - startPage + 1).keys()].map((number) => (\r\n            <Button\r\n              key={startPage + number}\r\n              variant={currentPage === startPage + number ? 'primary' : 'secondary'}\r\n              onClick={() => handlePageChange(startPage + number)}\r\n              className=\"mx-1\"\r\n            >\r\n              {startPage + number}\r\n            </Button>\r\n          ))}\r\n          {currentPage < totalPages && (\r\n            <>\r\n              <Button variant=\"secondary\" onClick={() => handlePageChange(currentPage + 1)} className=\"mx-1\">\r\n                <FaArrowRight />\r\n              </Button>\r\n              <Button variant=\"secondary\" onClick={() => handlePageChange(totalPages)} className=\"mx-1\">\r\n                <FaAngleDoubleRight />\r\n              </Button>\r\n            </>\r\n          )}\r\n        </Col>\r\n      </Row>\r\n\r\n      {/* View Details Modal */}\r\n      <Modal show={showDetailsModal} onHide={() => setShowDetailsModal(false)} centered>\r\n        <Modal.Header closeButton>\r\n          <Modal.Title>Audit Log Details</Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body>\r\n          {selectedLog ? (\r\n            <>\r\n              <p><strong>ID:</strong> {selectedLog.id}</p>\r\n              <p><strong>Resource Type:</strong> {selectedLog.resource_type}</p>\r\n              <p><strong>Action:</strong> {selectedLog.action.replace('AuditAction.', '')}</p>\r\n              <p><strong>User:</strong> {users[selectedLog.user_id] || 'Unknown User'}</p>\r\n              <p><strong>Resource ID:</strong> {selectedLog.resource_id || 'N/A'}</p>\r\n              <p><strong>Date:</strong> {new Date(selectedLog.timestamp).toLocaleString()}</p>\r\n              <p><strong>Details:</strong> {selectedLog.details}</p>\r\n              <p><strong>IP Address:</strong> {selectedLog.ip_address || 'N/A'}</p>\r\n              <p><strong>User Agent:</strong> {selectedLog.user_agent || 'N/A'}</p>\r\n            </>\r\n          ) : (\r\n            <p>No details available.</p>\r\n          )}\r\n        </Modal.Body>\r\n        <Modal.Footer>\r\n          <Button variant=\"secondary\" onClick={() => setShowDetailsModal(false)}>\r\n            Close\r\n          </Button>\r\n        </Modal.Footer>\r\n      </Modal>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AuditTrailPage;\r\n"],"names":["_ref","showToast","auditLogs","setAuditLogs","useState","users","setUsers","loading","setLoading","error","setError","filter","setFilter","resourceType","action","startDate","endDate","showDetailsModal","setShowDetailsModal","selectedLog","setSelectedLog","resourceTypes","setResourceTypes","actions","setActions","currentPage","setCurrentPage","itemsPerPage","archiveView","setArchiveView","fetchAuditLogs","useCallback","async","logs","api","get","data","extractUniqueResourceTypesAndActions","console","uniqueResourceTypes","Set","map","log","resource_type","uniqueActions","replace","fetchUsers","response","usersMap","forEach","user","id","name","useEffect","filteredLogs","logDate","Date","timestamp","today","setDate","getDate","getDay","indexOfLastLog","indexOfFirstLog","currentLogs","slice","handlePageChange","pageNumber","totalPages","Math","ceil","length","startPage","max","floor","maxPageNumbers","endPage","min","_jsx","className","children","_jsxs","style","marginTop","padding","Row","Col","Form","md","Control","as","value","onChange","e","target","type","DatePicker","selected","date","placeholderText","Button","variant","onClick","post","FaSearch","Table","striped","bordered","hover","responsive","index","user_id","resource_id","details","toLocaleString","size","logId","handleViewDetails","FaInfoCircle","colSpan","_Fragment","FaAngleDoubleLeft","FaArrowLeft","Array","keys","number","FaArrowRight","FaAngleDoubleRight","Modal","show","onHide","centered","Header","closeButton","Title","Body","ip_address","user_agent","Footer"],"sourceRoot":""}