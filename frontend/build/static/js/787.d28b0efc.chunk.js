"use strict";(self.webpackChunkSales_tracking_app=self.webpackChunkSales_tracking_app||[]).push([[787],{9787:(e,r,a)=>{a.r(r),a.d(r,{default:()=>y});var s=a(5043),t=a(5865),n=a(1906),l=a(4449),c=a(2110),i=a(5795),d=a(7417),o=a(3519),h=a(1072),g=a(8602),u=a(4196),x=a(8861),j=a(6579),m=a(7929),A=a(9621),p=a(579);const y=e=>{var r;let{showToast:a}=e;const[y,v]=(0,s.useState)([]),[f,b]=(0,s.useState)(!0),[C,S]=(0,s.useState)(!1),[_,k]=(0,s.useState)(!1),[w,B]=(0,s.useState)(null),[E,N]=(0,s.useState)("add"),[P,G]=(0,s.useState)({name:"",ghpost_gps:"",address:"",city:"",region:""}),[W,F]=(0,s.useState)(""),[I,M]=(0,s.useState)(1),[R,T]=(0,s.useState)(1),$=JSON.parse(localStorage.getItem("user")),D=parseInt(null===$||void 0===$?void 0:$.role_id)||(null===$||void 0===$||null===(r=$.role)||void 0===r?void 0:r.id);(0,s.useEffect)((()=>{(async()=>{b(!0);try{const e=await A.A.get(`/branches/?sort_by=created_at&per_page=10&page=${I}`);v(e.data.branches),T(Math.ceil(e.data.total/10))}catch(e){console.error("Error fetching branches:",e),a("error","Failed to fetch branches. Please try again later.","Error")}finally{b(!1)}})()}),[a,I]);const H=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;N(e),F(""),"edit"===e&&r?(B(r),G({name:r.name,ghpost_gps:r.ghpost_gps,address:r.address,city:r.city,region:r.region})):G({name:"",ghpost_gps:"",address:"",city:"",region:""}),S(!0)},J=()=>{S(!1),B(null)};return f?(0,p.jsx)(d.A,{animation:"border"}):(0,p.jsxs)(o.A,{className:"mt-4",children:[(0,p.jsx)(h.A,{children:(0,p.jsx)(g.A,{md:12,children:(0,p.jsx)(t.A,{variant:"h4",gutterBottom:!0,children:"Branch Management"})})}),(0,p.jsx)(h.A,{children:(0,p.jsx)(g.A,{md:12,children:(2===D||3===D)&&(0,p.jsxs)(n.A,{variant:"contained",color:"primary",onClick:()=>H("add"),children:[(0,p.jsx)(j.g,{icon:m.QLR})," Add New Branch"]})})}),(0,p.jsx)(h.A,{className:"mt-4",children:(0,p.jsxs)(g.A,{md:12,children:[(0,p.jsxs)(u.A,{striped:!0,bordered:!0,hover:!0,children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{children:"Name"}),(0,p.jsx)("th",{children:"Address"}),(0,p.jsx)("th",{children:"Ghana Post GPS"}),(0,p.jsx)("th",{children:"City"}),(0,p.jsx)("th",{children:"Region"}),(0,p.jsx)("th",{children:"Actions"})]})}),(0,p.jsx)("tbody",{children:y.map((e=>(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:e.name}),(0,p.jsx)("td",{children:e.address}),(0,p.jsx)("td",{children:e.ghpost_gps}),(0,p.jsx)("td",{children:e.city}),(0,p.jsx)("td",{children:e.region}),(0,p.jsx)("td",{children:(2===D||3===D)&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(n.A,{variant:"contained",color:"secondary",onClick:()=>H("edit",e),className:"me-2",children:[(0,p.jsx)(j.g,{icon:m.MT7})," Edit"]}),(0,p.jsxs)(n.A,{variant:"contained",color:"error",onClick:()=>(e=>{e&&(B(e),k(!0))})(e),children:[(0,p.jsx)(j.g,{icon:m.BeE})," Delete"]})]})})]},e.id)))})]}),(0,p.jsx)(x.A,{children:Array.from({length:R},((e,r)=>(0,p.jsx)(x.A.Item,{active:r+1===I,onClick:()=>M(r+1),children:r+1},r+1)))})]})}),(0,p.jsx)(l.A,{open:C,onClose:J,style:{overflow:"auto"},children:(0,p.jsxs)(c.A,{style:{width:"50%",margin:"5% auto",padding:"20px",maxHeight:"80vh",overflowY:"auto"},children:[(0,p.jsx)(t.A,{variant:"h5",gutterBottom:!0,children:"add"===E?"Add New Branch":"Edit Branch"}),(0,p.jsx)(i.A,{fullWidth:!0,label:"Branch Name",value:P.name,onChange:e=>G({...P,name:e.target.value}),margin:"normal"}),(0,p.jsx)(i.A,{fullWidth:!0,label:"Address",value:P.address,onChange:e=>G({...P,address:e.target.value}),margin:"normal"}),(0,p.jsx)(i.A,{fullWidth:!0,label:"Ghana Post GPS",value:P.ghpost_gps,onChange:e=>G({...P,ghpost_gps:e.target.value}),margin:"normal",error:Boolean(W),helperText:W}),(0,p.jsx)(i.A,{fullWidth:!0,label:"City",value:P.city,onChange:e=>G({...P,city:e.target.value}),margin:"normal"}),(0,p.jsx)(i.A,{fullWidth:!0,label:"Region",value:P.region,onChange:e=>G({...P,region:e.target.value}),margin:"normal"}),(0,p.jsxs)(h.A,{className:"mt-3",children:[(0,p.jsx)(g.A,{md:6,children:(0,p.jsx)(n.A,{variant:"contained",color:"primary",onClick:async()=>{if(11===P.ghpost_gps.length)try{if("add"===E){const e=await A.A.post("/branches/",P);v((r=>[...r,e.data])),a("success","Branch added successfully.","Success")}else if("edit"===E&&w){const e=await A.A.put(`/branches/${w.id}`,P);v((r=>r.map((r=>r.id===w.id?e.data:r)))),a("success","Branch updated successfully.","Success")}J()}catch(e){console.error("Error saving branch:",e),a("error","Failed to save branch. Please try again later.","Error")}else F("Ghana Post GPS must be exactly 11 characters.")},children:"Save"})}),(0,p.jsx)(g.A,{md:6,children:(0,p.jsx)(n.A,{variant:"outlined",color:"secondary",onClick:J,children:"Cancel"})})]})]})}),(0,p.jsx)(l.A,{open:_,onClose:()=>k(!1),style:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,p.jsxs)(c.A,{style:{padding:"20px"},children:[(0,p.jsx)(t.A,{variant:"h6",gutterBottom:!0,children:"Are you sure you want to delete this branch?"}),(0,p.jsxs)(h.A,{className:"mt-3",children:[(0,p.jsx)(g.A,{md:6,children:(0,p.jsx)(n.A,{variant:"contained",color:"error",onClick:async()=>{if(w)try{await A.A.delete(`/branches/${w.id}`),v((e=>e.filter((e=>e.id!==w.id)))),a("success","Branch deleted successfully.","Success"),k(!1),B(null)}catch(e){console.error("Error deleting branch:",e),a("error","Failed to delete branch. Please try again later.","Error")}else a("error","No branch selected for deletion.","Error")},children:"Delete"})}),(0,p.jsx)(g.A,{md:6,children:(0,p.jsx)(n.A,{variant:"outlined",color:"secondary",onClick:()=>k(!1),children:"Cancel"})})]})]})})]})}}}]);
//# sourceMappingURL=787.d28b0efc.chunk.js.map