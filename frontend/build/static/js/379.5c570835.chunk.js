"use strict";(self.webpackChunkSales_tracking_app=self.webpackChunkSales_tracking_app||[]).push([[379],{7379:(e,a,t)=>{t.r(a),t.d(a,{default:()=>g});var s=t(5043),l=t(1072),r=t(8602),n=t(3814),i=t(4282),c=t(7417),d=t(4196),o=t(1899),m=t.n(o),x=(t(5015),t(9621)),h=t(3204),p=t(579);const g=e=>{let{showToast:a}=e;const[t,o]=(0,s.useState)([]),[g,j]=(0,s.useState)(!0),[u,v]=(0,s.useState)(null),[y,A]=(0,s.useState)({type:"",level:"",startDate:null,endDate:null}),[D,N]=(0,s.useState)(1),[b]=(0,s.useState)(50),[S,C]=(0,s.useState)(1),f=(0,s.useCallback)((async()=>{j(!0),v(null);try{const e={page:D,per_page:b,...y.type&&{type:y.type.toLowerCase()},...y.level&&{level:y.level},...y.startDate&&{start_date:y.startDate.toISOString()},...y.endDate&&{end_date:y.endDate.toISOString()}},a=await x.A.get("/logs/",{params:e}),t=a.data.logs||[];t.sort(((e,a)=>{const t=e.timestamp?e.timestamp.replace(",","."):"",s=a.timestamp?a.timestamp.replace(",","."):"",l=new Date(t);return new Date(s)-l})),o(t),C(a.data.total_pages||1)}catch(u){console.error("Error fetching logs:",u);let t="Failed to fetch logs. Please try again later.";u.response?t=u.response.data.message||t:u.request&&(t="Network error: Unable to reach the server."),v(t),a("danger",t,"Error")}finally{j(!1)}}),[D,b,y,a]);(0,s.useEffect)((()=>{f()}),[f]);const k=e=>{e<1||e>S||N(e)},w=Math.max(1,D-Math.floor(2.5)),L=Math.min(S,w+5-1),T=t.map((e=>(e=>{const a=/(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2},\d{3})/,t=e.match(a);if(t){const s=t[0],l=e.replace(a,"").trim(),r=new Date(s.replace(",","."));return{timestamp:isNaN(r.getTime())?"Invalid Date":r,message:l}}return{timestamp:"No Timestamp",message:e}})(e)));return(0,p.jsxs)("div",{style:{marginTop:"20px",padding:"20px"},children:[(0,p.jsx)(l.A,{className:"mb-4",children:(0,p.jsx)(r.A,{children:(0,p.jsx)("h2",{children:"Logs"})})}),(0,p.jsx)(n.A,{className:"mb-4",children:(0,p.jsxs)(l.A,{className:"align-items-end",children:[(0,p.jsx)(r.A,{xs:12,md:3,lg:2,children:(0,p.jsxs)(n.A.Control,{as:"select",value:y.type,onChange:e=>A({...y,type:e.target.value.toLowerCase()}),"aria-label":"Log Type",children:[(0,p.jsx)("option",{value:"",children:"Log Type"}),(0,p.jsx)("option",{value:"general",children:"General"}),(0,p.jsx)("option",{value:"error",children:"Error"}),(0,p.jsx)("option",{value:"success",children:"Success"})]})}),(0,p.jsx)(r.A,{xs:12,md:3,lg:2,children:(0,p.jsxs)(n.A.Control,{as:"select",value:y.level,onChange:e=>A({...y,level:e.target.value}),"aria-label":"Log Level",children:[(0,p.jsx)("option",{value:"",children:"Log Level"}),(0,p.jsx)("option",{value:"info",children:"INFO"}),(0,p.jsx)("option",{value:"warning",children:"WARNING"}),(0,p.jsx)("option",{value:"error",children:"ERROR"})]})}),(0,p.jsx)(r.A,{xs:12,md:3,lg:2,children:(0,p.jsx)(m(),{selected:y.startDate,onChange:e=>A({...y,startDate:e}),placeholderText:"Start Date",className:"form-control","aria-label":"Start Date",showTimeSelect:!0,dateFormat:"Pp"})}),(0,p.jsx)(r.A,{xs:12,md:3,lg:2,children:(0,p.jsx)(m(),{selected:y.endDate,onChange:e=>A({...y,endDate:e}),placeholderText:"End Date",className:"form-control","aria-label":"End Date",showTimeSelect:!0,dateFormat:"Pp"})}),(0,p.jsxs)(r.A,{xs:12,md:3,lg:2,children:[(0,p.jsxs)(i.A,{variant:"primary",onClick:()=>{y.startDate&&y.endDate&&y.startDate>y.endDate?a("warning","Start date must be before end date.","Invalid Date Range"):(N(1),f())},"aria-label":"Filter Logs",children:[(0,p.jsx)(h.KSO,{})," Filter"]}),(0,p.jsxs)(i.A,{variant:"secondary",onClick:()=>{A({type:"",level:"",startDate:null,endDate:null}),N(1),f()},className:"ms-2","aria-label":"Reset Filters",children:[(0,p.jsx)(h.EEI,{})," Reset"]})]})]})}),u&&(0,p.jsx)("p",{className:"text-center text-danger",children:u}),g&&(0,p.jsx)("div",{className:"text-center my-3",children:(0,p.jsx)(c.A,{animation:"border","aria-label":"Loading logs..."})}),!g&&(0,p.jsxs)(d.A,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{children:"#"}),(0,p.jsx)("th",{children:"Timestamp"}),(0,p.jsx)("th",{children:"Message"})]})}),(0,p.jsx)("tbody",{children:T.length>0?T.map(((e,a)=>(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:(D-1)*b+a+1}),(0,p.jsx)("td",{children:"string"===typeof e.timestamp?e.timestamp:e.timestamp.toLocaleString()}),(0,p.jsx)("td",{children:e.message})]},a))):(0,p.jsx)("tr",{children:(0,p.jsx)("td",{colSpan:"3",className:"text-center",children:"No logs found"})})})]}),!g&&S>1&&(0,p.jsx)(l.A,{className:"mt-3",children:(0,p.jsxs)(r.A,{className:"text-center",children:[D>1&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(i.A,{variant:"secondary",onClick:()=>k(1),className:"mx-1","aria-label":"First Page",children:(0,p.jsx)(h.X8f,{})}),(0,p.jsx)(i.A,{variant:"secondary",onClick:()=>k(D-1),className:"mx-1","aria-label":"Previous Page",children:(0,p.jsx)(h.QVr,{})})]}),[...Array(L-w+1).keys()].map((e=>(0,p.jsx)(i.A,{variant:D===w+e?"primary":"secondary",onClick:()=>k(w+e),className:"mx-1","aria-label":`Page ${w+e}`,children:w+e},w+e))),D<S&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(i.A,{variant:"secondary",onClick:()=>k(D+1),className:"mx-1","aria-label":"Next Page",children:(0,p.jsx)(h.Z0P,{})}),(0,p.jsx)(i.A,{variant:"secondary",onClick:()=>k(S),className:"mx-1","aria-label":"Last Page",children:(0,p.jsx)(h.eaw,{})})]})]})})]})}}}]);
//# sourceMappingURL=379.5c570835.chunk.js.map