"use strict";(self.webpackChunkSales_tracking_app=self.webpackChunkSales_tracking_app||[]).push([[379],{7379:(e,a,s)=>{s.r(a),s.d(a,{default:()=>g});var t=s(5043),l=s(1072),r=s(8602),n=s(3814),i=s(4282),c=s(7417),o=s(4196),d=s(1899),x=s.n(d),m=(s(5015),s(9621)),h=s(3204),p=s(579);const g=e=>{let{showToast:a}=e;const[s,d]=(0,t.useState)([]),[g,j]=(0,t.useState)(!0),[u,v]=(0,t.useState)(null),[y,A]=(0,t.useState)({type:"",level:"",startDate:null,endDate:null}),[D,N]=(0,t.useState)(1),[b]=(0,t.useState)(50),[f,C]=(0,t.useState)(1),S=(0,t.useCallback)((async()=>{j(!0),v(null);try{const e={page:D,per_page:b,sort_order:"desc",...y.type&&{type:y.type.toLowerCase()},...y.level&&{level:y.level}},a=await m.A.get("/logs/",{params:e}),s=a.data.logs||[];d(s),C(a.data.total_pages||1)}catch(u){console.error("Error fetching logs:",u);let s="Failed to fetch logs. Please try again later.";u.response?s=u.response.data.message||s:u.request&&(s="Network error: Unable to reach the server."),v(s),a("danger",s,"Error")}finally{j(!1)}}),[D,b,y,a]);(0,t.useEffect)((()=>{S()}),[S]);const k=e=>{e<1||e>f||N(e)},w=e=>{const a=/(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2},)/,s=e.match(a);if(s){const t=s[0].replace(",",""),l=e.replace(a,"").trim(),r=new Date(t);return{timestamp:isNaN(r.getTime())?"Invalid Date":r,message:l}}return{timestamp:"No Timestamp",message:e}},L=(0,t.useMemo)((()=>s.filter((e=>{const a=w(e).timestamp,s=y.startDate?new Date(y.startDate):null,t=y.endDate?new Date(y.endDate):null;return(!s||a>=s)&&(!t||a<=t)}))),[s,y]),T=(0,t.useMemo)((()=>L.map((e=>w(e)))),[L]),F=Math.max(1,D-Math.floor(2.5)),P=Math.min(f,F+5-1);return(0,p.jsxs)("div",{style:{marginTop:"20px",padding:"20px"},children:[(0,p.jsx)(l.A,{className:"mb-4",children:(0,p.jsx)(r.A,{children:(0,p.jsx)("h2",{children:"Logs"})})}),(0,p.jsx)(n.A,{className:"mb-4",children:(0,p.jsxs)(l.A,{className:"align-items-end",children:[(0,p.jsx)(r.A,{xs:12,md:3,lg:2,children:(0,p.jsxs)(n.A.Control,{as:"select",value:y.type,onChange:e=>A({...y,type:e.target.value.toLowerCase()}),"aria-label":"Log Type",children:[(0,p.jsx)("option",{value:"",children:"Log Type"}),(0,p.jsx)("option",{value:"general",children:"General"}),(0,p.jsx)("option",{value:"error",children:"Error"}),(0,p.jsx)("option",{value:"success",children:"Success"})]})}),(0,p.jsx)(r.A,{xs:12,md:3,lg:2,children:(0,p.jsxs)(n.A.Control,{as:"select",value:y.level,onChange:e=>A({...y,level:e.target.value}),"aria-label":"Log Level",children:[(0,p.jsx)("option",{value:"",children:"Log Level"}),(0,p.jsx)("option",{value:"info",children:"INFO"}),(0,p.jsx)("option",{value:"warning",children:"WARNING"}),(0,p.jsx)("option",{value:"error",children:"ERROR"})]})}),(0,p.jsx)(r.A,{xs:12,md:3,lg:2,children:(0,p.jsx)(x(),{selected:y.startDate,onChange:e=>A({...y,startDate:e}),placeholderText:"Start Date",className:"form-control","aria-label":"Start Date",showTimeSelect:!0,dateFormat:"Pp"})}),(0,p.jsx)(r.A,{xs:12,md:3,lg:2,children:(0,p.jsx)(x(),{selected:y.endDate,onChange:e=>A({...y,endDate:e}),placeholderText:"End Date",className:"form-control","aria-label":"End Date",showTimeSelect:!0,dateFormat:"Pp"})}),(0,p.jsxs)(r.A,{xs:12,md:3,lg:2,children:[(0,p.jsxs)(i.A,{variant:"primary",onClick:()=>{y.startDate&&y.endDate&&y.startDate>y.endDate?a("warning","Start date must be before end date.","Invalid Date Range"):(N(1),S())},"aria-label":"Filter Logs",children:[(0,p.jsx)(h.KSO,{})," Filter"]}),(0,p.jsxs)(i.A,{variant:"secondary",onClick:()=>{A({type:"",level:"",startDate:null,endDate:null}),N(1),S()},className:"ms-2","aria-label":"Reset Filters",children:[(0,p.jsx)(h.EEI,{})," Reset"]})]})]})}),u&&(0,p.jsx)("p",{className:"text-center text-danger",children:u}),g&&(0,p.jsx)("div",{className:"text-center my-3",children:(0,p.jsx)(c.A,{animation:"border","aria-label":"Loading logs..."})}),!g&&(0,p.jsxs)(o.A,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{children:"#"}),(0,p.jsx)("th",{children:"Timestamp"}),(0,p.jsx)("th",{children:"Message"})]})}),(0,p.jsx)("tbody",{children:T.length>0?T.map(((e,a)=>(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:(D-1)*b+a+1}),(0,p.jsx)("td",{children:"string"===typeof e.timestamp?e.timestamp:e.timestamp.toLocaleString()}),(0,p.jsx)("td",{children:e.message})]},a))):(0,p.jsx)("tr",{children:(0,p.jsx)("td",{colSpan:"3",className:"text-center",children:"No logs found"})})})]}),!g&&f>1&&(0,p.jsx)(l.A,{className:"mt-3",children:(0,p.jsxs)(r.A,{className:"text-center",children:[D>1&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(i.A,{variant:"secondary",onClick:()=>k(1),className:"mx-1","aria-label":"First Page",children:(0,p.jsx)(h.X8f,{})}),(0,p.jsx)(i.A,{variant:"secondary",onClick:()=>k(D-1),className:"mx-1","aria-label":"Previous Page",children:(0,p.jsx)(h.QVr,{})})]}),[...Array(P-F+1).keys()].map((e=>(0,p.jsx)(i.A,{variant:D===F+e?"primary":"secondary",onClick:()=>k(F+e),className:"mx-1","aria-label":`Page ${F+e}`,children:F+e},F+e))),D<f&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(i.A,{variant:"secondary",onClick:()=>k(D+1),className:"mx-1","aria-label":"Next Page",children:(0,p.jsx)(h.Z0P,{})}),(0,p.jsx)(i.A,{variant:"secondary",onClick:()=>k(f),className:"mx-1","aria-label":"Last Page",children:(0,p.jsx)(h.eaw,{})})]})]})})]})}}}]);
//# sourceMappingURL=379.c78a0e73.chunk.js.map